h1. NetworkCoding

Network Coding can enable a relay node to combine two packets into a single transmission, thus saving airtime. To make receivers able to decode a network coded packet, it must know one of the two combined packets. This is obtained by buffering own transmissions as well as packets overheard in promiscuous mode. Relays detects when neighbors should be able to overhear each other and tries to only code packets towards destinations that should be able to decode.

An often used example of network coding is the X-topology, where two sets of nodes communicate through the same relay:
!x_nc.png!

Here Node C and Node D both receive the same network coded packet, and they both use the overheard packet (from Node A and Node B, respectively) to decode the received packet. In certain scenarios (e.g. heavy load traffic intersects at a relay), Network Coding can give up to 1.6 times gain in total throughput. Under less load, the relay might hold back packets up to 10 ms before forwarding these, as it tries to get packets to combine.

h3. Requirements

For network coding to work, it is required to have an enabled and working promiscuous mode on all nodes, as promiscuity is used to both overhear packets an receive network coded packets. Be aware that many wireless devices has non-working promiscuous mode, so some testing might be required.

To enable network coding, enable it a compile time (consult "the README.external file":http://www.open-mesh.org/projects/batman-adv/repository/revisions/master/entry/README.external to learn how to set the compile option). It can be disabled at runtime in sysfs:
<pre>
echo 0 > /sys/class/net/bat0/mesh/log_level 
</pre>