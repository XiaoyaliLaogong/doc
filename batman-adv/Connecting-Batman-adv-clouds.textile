h1. How to Interconnect different Batman-adv clouds (DRAFT)

h2. Overview

* Use case scenario (picture).
* Need to combine intra and iter-cloud metrics.
* Use batman-adv over both intra and inter connections to get metric combination for free.
* Layer-3 routing protocol to exchange metrics
* Layer-3 routing daemon and DHCP interaction for intra-cloud subnets advertisement
* GW feature for global route decision

!batman-l2-l3.png!

h2. Layer-2 Anycast

L2 Anycast consists in assignng the same MAC address to two *different* non-mesh clients and in leaving to batman-adv the decision of which one should be contacted.
Batman-adv will choose the best path towards the client (which looks like being one only since the two hosts have the same MAC address) on a metric basis.

This mechanism works thanks to the Bridge Loop Avoidance II component which allows the same client to be reachable via different originators. The L2 Anycast exploits this feature by placing several non-mesh clients in the network having the same MAC address.
The result will be again that *batman-adv will try to contact the client behind the best path*.

The macvlan kernel module can be used to create several virtual interfaces on top of an already existing one. The new interfaces can have a user defined MAC address and will not apply any tagging, this way it is possible to create as many non-mesh clients as the user wants on the same node.
This is an example on how to create a virtual interface on top of another one:
<pre>
# ip link add link bat0 name veth0 type macvlan
</pre>

