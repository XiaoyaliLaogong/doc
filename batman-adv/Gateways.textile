= Batman-adv gateways =

{{{
#!div style="width: 46em; text-align: justify"

In other words: It is unpredictable and does not take link qualities

=== The default route case ===

The subject of manipulating the IP (layer 3) default route with a layer 2 routing protocol has stirred up controversy between those who believe in a clean network layer separation and those who need this functionality. The former claim that a well-designed protocol should not mess with other layers but instead collaborates with tools made for higher layers. The later group has pointed out that the rule of network layer separation can be bent in real world applications and to improve usability. To achieve a compromise the gateway mechanism is disabled per default and only operates on top of DHCP (details below). Feel free to contact us in case you want to propose alternative ideas.


=== The concept ===

As the whole gateway functionality is based on DHCP, the protocol assumes each gateway runs its own DHCP server and each client runs a DHCP client. When a DHCP client is started it will issue a DHCP request which is broadcasted in the entire network. Every DHCP server will send a reply via unicast back to the client which then has to choose one of the responding DHCP servers as its gateway.

[[Image(wiki:batman-adv-gateways:gateway1.png)]]

Which gateway will be selected by the client depends on the number of DHCP servers / packet loss / delay / DHCP client software / etc. 

Once the gateway feature has been activated batman-adv floods the networks with gateway information, so that each batman-adv knows all other gateways (including the link quality). A batman-adv gateway client will choose its gateway (based on user defined criteria) long before DHCP is started. As soon as a DHCP request from a client comes in batman-adv will not broadcast the packet but only send it to the chosen batman-adv gateway.

[[Image(wiki:batman-adv-gateways:gateway2.png)]]

The DHCP client will then select the gateway batman-adv prefers as only this gateway replied to the request.


=== The configuration ===


}}}