
= Using the batman git repository =

{{{
#!div style="width: 40em; text-align: justify"

If you want to find out why we also have a git repository now, please read [wiki:2009-10-23-batman-goes-mainline here].

=== Checkout ===

To retrieve the latest changes you can pull from the read-only http frontend. Your are about to download 300MB of sources - that may take a while!
}}}

{{{
git clone http://git.open-mesh.org/batman-adv/ batman-adv-git
}}}

{{{
#!div style="width: 40em; text-align: justify"

=== Branches ===

The git repository is divided into several branches to make working easier.

'''master branch'''

The master branch is a clone of the batman kernel module SVN found at http://downloads.open-mesh.org/svn/batman/trunk/batman-adv-kernelland/

The idea is that all kernel changes are built on top of the SVN, so that changes which affect all branches can easily trickle down. A post-commit script makes sure that the SVN  is in sync with the git master branch all the time.

In fact you will never work with this branch itself but one of the other branches.

'''maint branch'''

The maint is a branch only maintained in git to gather bug fixes for the latest release. Cherry-pick is used to get commits from the master branch and git-am to insert patches from mailboxes.

Create branch associated with the remote-tracking branch after cloning the repository
}}}

{{{
git checkout -b maint --track origin/maint
}}}

Cherry-picking a commit from master branch

{{{
git checkout maint
git cherry-pick $SHA1
}}}

{{{
#!div style="width: 40em; text-align: justify"

'''linux branch'''

The linux branch is a clone of Linus Torvalds developer branch. With the help of some git voodoo the maint branch is merged with this branch in the folder: drivers/staging/batman-adv/. If you wish to merge the latest maint branch changes into the linux branch you need to switch to the linux branch:
}}}

{{{
git checkout linux
}}}

and merge the maint branch into this one:

{{{
git fetch origin
git merge -s subtree origin/maint
}}}

{{{
#!div style="width: 40em; text-align: justify"

If you wish to pull Linus latest changes and merge it you need to add the remote branch first (you can omit that step if you already have it).
}}}

{{{
git remote add torvalds git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux-2.6.git
}}}

Fetch its content and merge it:

{{{
git checkout linux
git fetch torvalds
git merge torvalds/master
}}}

To upload your changes you need to run:
{{{
git checkout linux
git push origin linux
}}}

{{{
#!div style="width: 40em; text-align: justify"

'''difference between SVN and git'''

If you need to see the difference between the SVN repos and the batman-adv driver in drivers/staging/batman-adv/ you can run this command:
}}}

{{{
git diff origin/maint: linux:drivers/staging/batman-adv/
}}}

{{{
#!div style="width: 40em; text-align: justify"

'''adding a branch'''

In case you want to add your own branch for testing purposes or simply wish to understand the magic.
}}}

{{{
git remote add $remote_name $git_url
git fetch $remote_name

git checkout -b $new_branch_name $remote_name/master
git merge -s ours --no-commit master
git read-tree --prefix=drivers/staging/batman-adv/ -u maint
git commit -m "Add batman-adv to my new branch"
}}}

=== TODO ===

We maintain a TODO file in the git repository that you can see here: 

[[Include(http://git.open-mesh.org/TODO.html)]]

If you are interested in helping us out you can grab one item, make a patch[[BR]]
and send it to our [wiki:MailingList Mailinglist].
